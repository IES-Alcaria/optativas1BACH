<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta content="initial-scale=1, shrink-to-fit=no, width=device-width" name="viewport">
      <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i|Roboto+Mono:300,400,700|Roboto+Slab:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Add Material CSS, replace Bootstrap CSS -->
    <link href="assets/css/material.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/home.css">
    <title>Formulario de Preferencias de Asignaturas</title>
    <style>
        .error {
            color: red;
            display: none;
        }
        .erroro {
            color: red;
            display: none;
        }
        .mensaje {
            color: blue;
            display: block;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.6.0.js"  integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="assets/js/material.min.js"></script>

    <script>
        function validateForm() {
	    let e1=calcular_distintoso();
	    let e2=calcular_distintos();
	    return (e1 && e2);
	}

	function calcular_distintoso(){
            let opto = [document.getElementById("opt1o").value,document.getElementById("opt2o").value,document.getElementById("opt3o").value,document.getElementById("opt4o").value,document.getElementById("opt5o").value,document.getElementById("opt6o").value];

            let erroro = document.getElementById("erroro");

            let distintos2=true;

	    let i=0;
	    let j=0;

	    for(i=0;((i<opto.length-1) && (distintos2==true));i++){
		for(j=i+1;((j<opto.length) && (distintos2==true));j++){
		    distintos2=(opto[i]!=opto[j]);
		}
	    }

	    if (distintos2==false) {
                erroro.style.display = "block";
                return false;
            } else {
                erroro.style.display = "none";
                return true;
            }
        }


	function calcular_distintos(){
            let opt = [document.getElementById("opt1").value,document.getElementById("opt2").value,document.getElementById("opt3").value,document.getElementById("opt4").value,document.getElementById("opt5").value,document.getElementById("opt6").value,document.getElementById("opt7").value,document.getElementById("opt8").value,document.getElementById("opt9").value,document.getElementById("opt10").value,document.getElementById("opt11").value,document.getElementById("opt12").value];

            let error = document.getElementById("error");

            let distintos=true;

	    let i=0;
	    let j=0;

	    for(i=0;((i<opt.length-1) && (distintos==true));i++){
		for(j=i+1;((j<opt.length) && (distintos==true));j++){
		    distintos=(opt[i]!=opt[j]);
		}
	    }

	    if (distintos==false) {
                error.style.display = "block";
                return false;
            } else {
                error.style.display = "none";
                return true;
            }
        }
    </script>
</head>
<body id="cuerpo">
    <form name="my-google-sheet" id="my-google-sheet"  method="POST" onsubmit="return validateForm()">
	<div id="encabezado" style="display:flex;align-items:center;">
	    <img src="LOGO_IES_ALCARIA.png" width="10%">
	    <h2 style="flex-grow:1;display:inline-block;">PREFERENCIA DE MATERIAS OPTATIVAS PARA 1ºBACHILLERATO (HH Y CCSS)</h2>
	</div>
        <br>
	<fieldset>
            <legend>INTRODUCE TU CORREO DE G.EDUCAAND.ES</legend>
	    <br>
            <label for="email">Correo electrónico de @g.educaand.es:</label>
            <input type="email" id="email" name="Email" size="25" required><br><br>
        </fieldset><br>

	<P><B>RECUERDA:</B> Las materias comunes obligatorias en 1º BACHILLERATO DE HH Y CCSS son Educación Física, Filosofía, Lengua Castellana y Literatura y Primera Lengua Extranjera (Inglés).</P>

	<br><a href="Información sobre optativas 1ºBACH.pdf" target="_blank">Ver información sobre las asignaturas optativas</a><br><br>

	<br>
        <label for="mates_latin">SELECCIONA UNA DE ESTAS MATERIAS:</label>
        <select id="mates_latin" name="Matemáticas/Latín" required>
            <option value="Matemáticas aplicadas a las CCSS I">Matemáticas aplicadas a las CCSS I</option>
            <option value="Latín I">Latín I</option>
        </select><br><br><br>

        <fieldset>
            <legend>MATERIAS ESPECÍFICAS DE LA MODALIDAD (son asignaturas de 4 horas cada una)</legend>
	    <h3 style="color:red;">¡OJO!: LA ELECCIÓN DE ESTAS MATERIAS ES MUY IMPORTANTE, PUES DETERMINA EL ITINERARIO DEL BACHILLERATO</h3>
	    <label id="mensaje" class="mensaje">A elegir 2, pero debes valorar todas las asignaturas de tal forma que le asignes un 1 a la asignatura que más te guste, un 2 a la segunda que más te guste, etc...</label>
            <br>

   	    <label for="opt1o">Economía:</label>
            <select id="opt1o" name="Economía" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select><br>

            <label for="opt2o">Griego I:</label>
            <select id="opt2o" name="Griego I" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select><br>

            <label for="opt3o">Historia del mundo contemporáneo:</label>
            <select id="opt3o" name="Historia del mundo contemporáneo" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select><br>

            <label for="opt4o">Latín I:</label>
            <select id="opt4o" name="Latín I" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select><br>

            <label for="opt5o">Literatura Universal:</label>
            <select id="opt5o" name="Literatura Universal" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select><br>

            <label for="opt6o">Matemáticas aplicadas a las CCSS:</label>
            <select id="opt6o" name="Matemáticas aplicadas a las CCSS" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select><br>

            <span id="erroro" class="erroro">No puedes repetir números en estas asignaturas.</span>
        </fieldset><br>

        <fieldset>
            <legend>OPTATIVAS PROPIAS DE LA COMUNIDAD AUTÓNOMA (son asignaturas de 2 horas cada una)</legend>
	    <br><label id="mensaje" class="mensaje">A elegir 2 (o una de modalidad de 4 horas), pero debes valorar todas las asignaturas de tal forma que le asignes un 1 a la asignatura que más te guste, un 2 a la segunda que más te guste, etc...</label>
            <br>
   	    <label for="opt1">Creación digital y pensamiento computacional:</label>
            <select id="opt1" name="Creación digital y pensamiento computacional" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt2">Cultura emprendedora y empresarial:</label>
            <select id="opt2" name="Cultura emprendedora y empresarial" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt3">Educación para la convivencia democrática I:</label>
            <select id="opt3" name="Educación para la convivencia democrática I" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt4">Patrimonio cultural y artístico de Andalucía:</label>
            <select id="opt4" name="Patrimonio cultural y artístico de Andalucía" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt5">Segunda Lengua Extranjera:</label>
            <select id="opt5" name="Segunda Lengua Extranjera" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt6">TIC I:</label>
            <select id="opt6" name="TIC I" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt7">Estadística I:</label>
            <select id="opt7" name="Estadística I" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt8">Inglés B1 Inicial:</label>
            <select id="opt8" name="Inglés B1 Inicial" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt9">Inteligencia Emocional I:</label>
            <select id="opt9" name="Inteligencia Emocional I" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt10">Radio: estudio de grabación:</label>
            <select id="opt10" name="Radio: estudio de grabación" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt11">Francés B1:</label>
            <select id="opt11" name="Francés B1" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <label for="opt12">Taller de Cine:</label>
            <select id="opt12" name="Taller de Cine" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select><br>

            <span id="error" class="error">No puedes repetir números en estas asignaturas.</span>
        </fieldset><br>

        <br><label for="religion">SELECCIONA UNA DE ESTAS MATERIAS:</label>
        <select id="religion" name="Religión/Alternativa" required>
            <option value="Religión">Religión</option>
            <option value="Proyectos transversales de educación en valores">Proyectos transversales de educación en valores</option>
        </select><br><br><br>
    	<button type="submit" class="btn btn-primary btn-sm">Enviar respuestas</button>
    </form>


    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyRR8qZCNE2Iw9A7C29QBcG07IUDmCA1BcdCkxD9rxk_ooY6SvYwCQUR8NxfR2NzVs3JA/exec'
        const form = document.forms['my-google-sheet']

        form.addEventListener('submit', e => {
	  if (validateForm()){
            e.preventDefault()
            fetch(scriptURL, { method: 'POST', body: new FormData(form)})
            .then(response =>
               
            console.log('Success!', response))
            .catch(error => console.error('Error!', error.message))

	    document.getElementById("my-google-sheet").reset();
	    document.getElementById("cuerpo").innerHTML = "";
	    document.getElementById("cuerpo").innerText = "RESPUESTA ENVIADA, MUCHAS GRACIAS.";
          }
        }) 
    </script>

</body>
</html>
